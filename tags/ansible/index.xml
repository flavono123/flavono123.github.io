<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>ansible on flavono123</title><link>https://flavono123.github.io/tags/ansible/</link><description>Recent content in ansible on flavono123</description><generator>Hugo -- gohugo.io</generator><language>ko-kr</language><lastBuildDate>Tue, 08 Mar 2022 23:27:10 +0900</lastBuildDate><atom:link href="https://flavono123.github.io/tags/ansible/index.xml" rel="self" type="application/rss+xml"/><item><title>Ansible로 모든 VM을 SSH 연결하기</title><link>https://flavono123.github.io/posts/ansible-ssh-keygen/</link><pubDate>Tue, 08 Mar 2022 23:27:10 +0900</pubDate><guid>https://flavono123.github.io/posts/ansible-ssh-keygen/</guid><description>언제나 그렇듯 삽질 후 깔끔하게 정리한다. VM끼리 ssh로 연결하고 싶었다. 보통은 쉘 스크립트로 프로비저닝했다. 그런데 ansible로 해보니 몇가지 어려운 점이 있었다:
authorized_keys를 만들 때 각 VM에서 만든 공개키를 &amp;lsquo;모아야&amp;rsquo; 한다. SSH key를 &amp;lsquo;새로 만든 VM만&amp;rsquo; authorized_keys를 갱신해야 한다. SSH key gen은 Self-signed Certificate을 해보며 잘 이해해서 ansible-galaxy에 있는 community.crypto.openssh_keypair로 대체했다.
Special varibables VM을 up하고 아무도 SSH 키 쌍이 없는 상태에선 모두 키를 만들고 공개키를 모아서 모두의 authorized_keys 파일에 써주어야 한다.</description></item><item><title>MongoDB 모니터가 빠진 건에 대하여</title><link>https://flavono123.github.io/posts/mongodb-monitor/</link><pubDate>Wed, 23 Feb 2022 22:50:45 +0900</pubDate><guid>https://flavono123.github.io/posts/mongodb-monitor/</guid><description>어느 날, MongoDB 서버에서 CPU 사용율이 높다는 알람이 왔다. CPU 사용율은 금방 정상을 돌아왔지만, pmm-client가 설치되지 않아서 쿼리를 특정할 수 없었다. pmm-client는 MongoDB 각 멤버가 재시작 되면서(한때 장애로 failover를 밥 먹듯이 했다&amp;hellip;) server로부터 떨어진거 같았다. 최근엔 재시작 되는 일 없이 안정적으로 서비스 실행 중이라 다시 붙이기로 했다. 그리고 그 사이에 클러스터에 변화도 생겼는데 이것도 반영했다.
클러스터 구성 현재 클러스터 구성은 다음과 같다:
host1 host2 host3 host4 host5 host6 replicaset1 replicaset1 replicaset1 replicaset2 replicaset2 replicaset2 config config config router router router router router router 총 6대의 호스트에 설치되어 있다.</description></item></channel></rss>