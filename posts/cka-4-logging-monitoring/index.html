<!doctype html><html lang=en>
<head>
<meta charset=utf-8>
<meta http-equiv=x-ua-compatible content="IE=edge">
<meta name=viewport content="width=device-width,initial-scale=1">
<title>CKA with Practice Tests: Logging & Monitoring(+ Prometheus, Grafana) | flavono123</title>
<link rel=stylesheet href=https://flavono123.github.io/assets/css/post.css>
<script defer src=https://flavono123.github.io/assets/js/lbox.js></script>
<link rel=stylesheet href=https://flavono123.github.io/assets/css/common.css>
</head>
<body>
<main>
<header>
<a class=site-title href=https://flavono123.github.io/>flavono123</a>
</header>
<section class=article>
<div class=article-header>
<h2 class=article-title>CKA with Practice Tests: Logging & Monitoring(+ Prometheus, Grafana)</h2>
<small class=date>Tue Jan 25, 2022</small>
<div class=tags>
<a href=https://flavono123.github.io/tags/cka class=tag>cka</a>
<a href=https://flavono123.github.io/tags/prometheus class=tag>prometheus</a>
</div>
</div>
<div class=content><h2 id=í´ëŸ¬ìŠ¤í„°-ì»´í¬ë„ŒíŠ¸-ëª¨ë‹ˆí„°>í´ëŸ¬ìŠ¤í„° ì»´í¬ë„ŒíŠ¸ ëª¨ë‹ˆí„°</h2>
<p>ëª¨ë‹ˆí„° ëŒ€ìƒì€ í¬ê²Œ ë…¸ë“œì™€ íŒŒë“œ ë‘ê°œë¡œ ë‚˜ë‰œë‹¤. ê¸°ë³¸ì ì¸ <a href=https://github.com/kubernetes/metrics/blob/master/pkg/apis/metrics/v1beta1/types.go>ë©”íŠ¸ë¦­ API</a> ìˆë‹¤. ì´ë¥¼ ì§‘ê³„í•˜ë ¤ë©´ ë³„ë„ì˜ ë©”íŠ¸ë¦­ ì„œë²„ê°€ í•„ìš”í•˜ë‹¤.</p>
<p>ë¨¼ì € ë¡œì»¬ì— êµ¬ì„±í•œ minikubeì˜ ê²½ìš° metrics-serverë¥¼ ì• ë“œì˜¨ìœ¼ë¡œ ì¶”ê°€í•˜ë©´ <code>kubectl top</code> ëª…ë ¹ìœ¼ë¡œ CPUì™€ ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ì„ ì•Œ ìˆ˜ ìˆë‹¤.</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>â¯ minikube version
minikube version: v1.24.0
commit: 76b94fb3c4e8ac5062daf70d60cf03ddcc0a741b

â¯ minikube addons enable metrics-server
    â–ª Using image k8s.gcr.io/metrics-server/metrics-server:v0.4.2
ğŸŒŸ  <span style=color:#e6db74>&#39;metrics-server&#39;</span> ì• ë“œì˜¨ì´ í™œì„±í™”ë˜ì—ˆìŠµë‹ˆë‹¤

â¯ minikube addons list
|-----------------------------|----------|--------------|-----------------------|
|         ADDON NAME          | PROFILE  |    STATUS    |      MAINTAINER       |
|-----------------------------|----------|--------------|-----------------------|
| ambassador                  | minikube | disabled     | unknown <span style=color:#f92672>(</span>third-party<span style=color:#f92672>)</span> |
| auto-pause                  | minikube | disabled     | google                |
| csi-hostpath-driver         | minikube | disabled     | kubernetes            |
| dashboard                   | minikube | disabled     | kubernetes            |
| default-storageclass        | minikube | enabled âœ…   | kubernetes            |
| efk                         | minikube | disabled     | unknown <span style=color:#f92672>(</span>third-party<span style=color:#f92672>)</span> |
| freshpod                    | minikube | disabled     | google                |
| gcp-auth                    | minikube | disabled     | google                |
| gvisor                      | minikube | disabled     | google                |
| helm-tiller                 | minikube | disabled     | unknown <span style=color:#f92672>(</span>third-party<span style=color:#f92672>)</span> |
| ingress                     | minikube | disabled     | unknown <span style=color:#f92672>(</span>third-party<span style=color:#f92672>)</span> |
| ingress-dns                 | minikube | disabled     | unknown <span style=color:#f92672>(</span>third-party<span style=color:#f92672>)</span> |
| istio                       | minikube | disabled     | unknown <span style=color:#f92672>(</span>third-party<span style=color:#f92672>)</span> |
| istio-provisioner           | minikube | disabled     | unknown <span style=color:#f92672>(</span>third-party<span style=color:#f92672>)</span> |
| kubevirt                    | minikube | disabled     | unknown <span style=color:#f92672>(</span>third-party<span style=color:#f92672>)</span> |
| logviewer                   | minikube | disabled     | google                |
| metallb                     | minikube | disabled     | unknown <span style=color:#f92672>(</span>third-party<span style=color:#f92672>)</span> |
| metrics-server              | minikube | enabled âœ…   | kubernetes            |
| nvidia-driver-installer     | minikube | disabled     | google                |
| nvidia-gpu-device-plugin    | minikube | disabled     | unknown <span style=color:#f92672>(</span>third-party<span style=color:#f92672>)</span> |
| olm                         | minikube | disabled     | unknown <span style=color:#f92672>(</span>third-party<span style=color:#f92672>)</span> |
| pod-security-policy         | minikube | disabled     | unknown <span style=color:#f92672>(</span>third-party<span style=color:#f92672>)</span> |
| portainer                   | minikube | disabled     | portainer.io          |
| registry                    | minikube | disabled     | google                |
| registry-aliases            | minikube | disabled     | unknown <span style=color:#f92672>(</span>third-party<span style=color:#f92672>)</span> |
| registry-creds              | minikube | disabled     | unknown <span style=color:#f92672>(</span>third-party<span style=color:#f92672>)</span> |
| storage-provisioner         | minikube | enabled âœ…   | kubernetes            |
| storage-provisioner-gluster | minikube | disabled     | unknown <span style=color:#f92672>(</span>third-party<span style=color:#f92672>)</span> |
| volumesnapshots             | minikube | disabled     | kubernetes            |
|-----------------------------|----------|--------------|-----------------------|

â¯ kubectl top node
NAME       CPU<span style=color:#f92672>(</span>cores<span style=color:#f92672>)</span>   CPU%   MEMORY<span style=color:#f92672>(</span>bytes<span style=color:#f92672>)</span>   MEMORY%   
minikube   515m         25%    3114Mi          81% 

â¯ kubectl top pod -n kube-system
NAME                                  CPU<span style=color:#f92672>(</span>cores<span style=color:#f92672>)</span>   MEMORY<span style=color:#f92672>(</span>bytes<span style=color:#f92672>)</span>   
coredns-78fcd69978-mkxm8              4m           22Mi            
etcd-minikube                         40m          57Mi            
kube-apiserver-minikube               135m         412Mi           
kube-controller-manager-minikube      50m          62Mi            
kube-proxy-68nvv                      1m           17Mi            
kube-scheduler-minikube               7m           20Mi            
kube-state-metrics-796889f8b9-9z78d   2m           14Mi            
metrics-server-77c99ccb96-rcjpw       6m           11Mi            
storage-provisioner                   4m           13Mi
</code></pre></div><p>ë©”íŠ¸ë¦­ ê²°ê³¼ëŠ” ê¸°ë³¸ì ìœ¼ë¡œ í”„ë¡œë©”í…Œìš°ìŠ¤ í˜•ì‹ìœ¼ë¡œ ë‚˜ì˜¨ë‹¤ê³  í•œë‹¤. ë©”íŠ¸ë¦­ ì„œë²„ëŠ” í´ëŸ¬ìŠ¤í„°ì˜ ëª¨ë“  ë…¸ë“œì— CPU, ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ì„ ì§ˆì˜í•œë‹¤. ë˜ ë…¸ë“œ ì¿ ë¸”ë¦¿ì˜ cAdvisor(container advisor)ë¥¼ í†µí•´ì„œ íŒŒë“œì˜ ë©”íŠ¸ë¦­ì„ ìˆ˜ì§‘í•œë‹¤. ê°•ì˜ì˜ ì„¤ëª…ì€ ì´ê²Œ ì „ë¶€ë‹¤. ê·¸ë¦¬ê³  ì—°ìŠµë¬¸ì œë„ top ì°ì–´ë³´ê³  ëë‚œë‹¤.</p>
<p>&mldr; ì¢€ ì‹œì‹œí•˜ì§€ë§Œ ì–´ì°¨í”¼ í´ëŸ¬ìŠ¤í„°ë¥¼ ìš´ì˜í•˜ëŠ” ì²˜ì§€ê°€ ì•„ë‹Œ <em>ì‹œí—˜ ë³´ê¸° ìœ„í•´ ê³µë¶€í•˜ëŠ”ë°</em> ì´ìª½ì„ ë” ê¹Šê²Œ ì•Œì•„ë³´ë ¤ í•´ë´¤ì í•œê³„ê°€ ìˆì„ê±° ê°™ì•˜ë‹¤. ë”°ë¼ì„œ cAdvisorë‚˜ ê°•ì˜ì—ì„œ ìì„¸íˆ ë‹¤ë£¨ì§€ ì•ŠëŠ” ë¶€ë¶„ì„ ë” ì°¾ì•„ë³´ì§„ ì•Šì•˜ë‹¤.</p>
<p>ë‹¤ë§Œ í”„ë¡œë©”í…Œìš°ìŠ¤ë¥¼ ë©”íŠ¸ë¦­ ì„œë²„ë¡œ ì—°ë™í•´ë³´ê³¤ ì‹¶ì—ˆë‹¤. ì›Œë‚™ ìœ ëª…í•˜ê³  ê¸°ìˆ  ìŠ¤íƒìœ¼ë¡œ ì“°ëŠ” ê³³ì´ ë§ì•„ì„œ ê¶ê¸ˆí–ˆë‹¤. ë”°ë¼ì„œ ì´ ê¸€ ëì— minikubeì—ì„œ ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„° ë©”íŠ¸ë¦­ ì„œë²„ë¡œì„œ í”„ë¡œë©”í…Œìš°ìŠ¤ + ê·¸ë¼íŒŒë‚˜ ì—°ë™ì„ ë‹¤ë£¬ë‹¤.</p>
<p><a href=https://kubernetes.io/ko/docs/tasks/debug-application-cluster/resource-usage-monitoring/>ì°¸ê³ : ë¦¬ì†ŒìŠ¤ ëª¨ë‹ˆí„°ë§ ë„êµ¬</a></p>
<h2 id=ì• í”Œë¦¬ì¼€ì´ì…˜-ë¡œê·¸>ì• í”Œë¦¬ì¼€ì´ì…˜ ë¡œê·¸</h2>
<p>ì—¬ê¸°ì„œ ì• í”Œë¦¬ì¼€ì´ì…˜ì´ë€ íŒŒë“œì—ì„œ ì‹¤í–‰í•˜ëŠ” ì»¨í…Œì´ë„ˆë¥¼ ì˜ë¯¸í•œë‹¤. ì‹¤í–‰ ì¤‘ì¸ íŒŒë“œì— ëŒ€í•´ <code>kubectl log -f &lt;pod></code>í•˜ë©´ í‘œì¤€ì¶œë ¥ì¸ ë¡œê·¸ë¥¼ ë³¼ ìˆ˜ ìˆë‹¤(Detached ë„ì»¤ì—ì„œ <code>docker log &lt;container></code> ì‹¤í–‰í•˜ëŠ” ê²ƒê³¼ ê°™ë‹¤). íŒŒë“œê°€ ì—¬ëŸ¬ ì»¨í…Œì´ë„ˆ ì‹¤í–‰ ì¤‘ì¼ ê²½ìš° <code>kubectl log -f &lt;pod> &lt;container></code>ë¡œ íŠ¹ì •í•  ìˆ˜ ìˆê³ , ì»¨í…Œì´ë„ˆë¥¼ ëˆ„ë½í•  ì‹œ ëŒ€í™”í˜•ìœ¼ë¡œ ë¬¼ì–´ë³¸ë‹¤.</p>
<h2 id=ì‹œí—˜-ëª…ë ¹íŒ-ëª¨ìŒ>ì‹œí—˜ ëª…ë ¹/íŒ ëª¨ìŒ</h2>
<p>ì‹œí—˜ê³¼ ê´€ë ¨í•œ ëª…ë ¹ì´ë‚˜ íŒì„ ì •ë¦¬í•œë‹¤. ì›ëœ ì €ë²ˆ Scheduler ì •ë¦¬ë¶€í„° í•„ìš”í•˜ë‹¤ê³  ìƒê°í–ˆì§€ë§Œ ì´ë²ˆ ì„¹ì…˜ ë¶„ëŸ‰ì´ ì ì–´ ì—¬ê¸°ì„œë¶€í„° ë„£ì–´ì•¼ì§€ í–ˆë‹¤. ê·¸ëŸ°ë° ì´ë²ˆ ì„¹ì…˜ì—” ì •ë¦¬í• ê²Œ ë”±íˆ ì—†ë‹¤. ê·¸ë˜ì„œ ì§€ë‚œ ì„¹ì…˜ì— ì •ë¦¬í•´ë‘” ê²ƒì´ì§€ë§Œ, ë‚´ìš©ì€ íŠ¹ì • ì„¹ì…˜ì—ë§Œ ì—°ê´€ ìˆì§€ ì•ŠëŠ” ì‹œí—˜ ì „ë°˜ì ìœ¼ë¡œ ì ìš©í•  ìˆ˜ ìˆëŠ” ëª…ë ¹ê³¼ íŒì´ë‹¤.</p>
<ul>
<li>ëª…ë ¹ìœ¼ë¡œ ì—¬ëŸ¬ ë ˆì´ë¸” ì…€ë ‰í„°ë¥¼ ì“¸ ë•Œ ì½¤ë§ˆë¡œ ì‡ëŠ”ë‹¤: e.g. <code>kubectl get all -l key1=val1,key2=val2</code></li>
<li>ì´ë¯¸ì§€ë¡œ íŒŒë“œ ìƒì„±: <code>kubectl run &lt;name> --image=&lt;image></code></li>
<li>ëª…ë ¹ ì˜µì…˜ìœ¼ë¡œ íŠ¹ì •í•  ìˆ˜ ì—†ëŠ” íŒŒë“œ ìŠ¤í™ì´ ìˆì„ ë•Œ ë¼ˆëŒ€ íŒŒì¼ ë§Œë“¤ê¸°: <code>kubectl run &lt;name> --image=&lt;image> --dry-run=client -o yaml > &lt;name>.yml</code></li>
<li>ë…¸ë“œ í…Œì¸íŠ¸ ì‚­ì œ: <code>kubectl taint no &lt;node> key=val-</code></li>
<li>íŒŒë“œ ë¦¬ìŠ¤íŠ¸ì—ì„œ ë…¸ë“œ í™•ì¸í•˜ê¸°: <code>kubectl get po -o wide</code></li>
<li>ë…¸ë“œ ë ˆì´ë¸”ë§: <code>kubectl label node &lt;node> &lt;key>=&lt;val></code></li>
<li>ë””í”Œë¡œì´ë¨¼íŠ¸ ìƒì„±: <code>kubectl create deploy &lt;name> --image=&lt;image> --replicas=&lt;replicas></code></li>
<li>ëª¨ë“  ë„¤ì„ìŠ¤í˜ì´ìŠ¤ì—ì„œ ë¦¬ì†ŒìŠ¤ ì¡°íšŒ: <code>kubectl get &lt;object> -A</code></li>
<li>ìƒˆ ëŒ€ëª¬ì…‹ ì •ì˜ íŒŒì¼ì„ ë§Œë“¤ ë•, ë ˆí”Œë¦¬ì¹´ì…‹ì„ dry-runí•˜ê³  kindë¥¼ ìˆ˜ì •</li>
<li>ë…¸ë“œ IPëŠ” <code>kubectl get no -o wide</code> ë¡œ í™•ì¸ ê°€ëŠ¥</li>
<li><code>kubectl get events -o wide</code> SOURCE íƒ­ì—ì„œ ì´ë²¤íŠ¸ì˜ ìŠ¤ì¼€ì¤„ëŸ¬ í™•ì¸ ê°€ëŠ¥</li>
</ul>
<p>Edit ë¶ˆê°€ëŠ¥í•œ íŒŒë“œ ìŠ¤í™ ìˆ˜ì •í•˜ê¸°</p>
<ul>
<li>spec.containers[*].image</li>
<li>spec.initContainers[*].image</li>
<li>spec.activeDeadlineSeconds</li>
<li>spec.tolerations</li>
<li>ì´ ë¶€ë¶„ì„ ìˆ˜ì •í•˜ë ¤ë©´ ìš°ì„  edit í•˜ì—¬ ë‹¤ë¥¸ ì´ë¦„ìœ¼ë¡œ ì €ì¥í•œë‹¤(vië¡œ <code>:w &lt;name>.yml</code>)</li>
<li>ê¸°ì¡´ íŒŒë“œëŠ” delete í•˜ê³  .yml ìˆ˜ì •í•˜ì—¬ apply</li>
<li>ë””í”Œë¡œì´ë¨¼íŠ¸ëŠ” template ì•„ë˜ë¥¼ ìˆ˜ì •í•˜ë©´ ìƒˆ íŒŒë“œë¥¼ ì‹¤í–‰í•œë‹¤(= edit ê°€ëŠ¥)</li>
</ul>
<p>ì¼ë°˜(ë‹¤ì´ë‚˜ë¯¹) íŒŒë“œ, ìŠ¤íƒœí‹± íŒŒë“œ, ëŒ€ëª¬ì…‹ êµ¬ë¶„ë²•</p>
<p>1.<code>kubectl describe &lt;pod> | grep Controlled</code></p>
<ul>
<li>Node/ ì´ë©´ ìŠ¤íƒœí‹± ë…¸ë“œ</li>
<li>DaemonSet/ ì´ë©´ ëŒ€ëª¬ì…‹</li>
<li>ë‚˜ë¨¸ì§„ ì¼ë°˜ íŒŒë“œ</li>
</ul>
<ol start=2>
<li>getìœ¼ë¡œ ë¦¬ìŠ¤íŠ¸í•˜ì—¬ ì´ë¦„ ë’¤ì— <code>-&lt;node></code> ê°€ ë¶™ìœ¼ë©´ ìŠ¤íƒœí‹± ë…¸ë“œ</li>
</ol>
<ul>
<li>spec.ownerReferences[*].kindë¥¼ í™•ì¸í•˜ê±°ë‚˜ í•„í„°í•´ë„ ë˜ì§€ë§Œ ëª…ë ¹ì´ ë³µì¡í•¨(ì•ì„  Controlled byì˜ ì•ë¶€ë¶„ê³¼ ê°™ë‹¤)</li>
<li>ì°¸ê³ : <a href=https://stackoverflow.com/questions/65657808/how-to-identify-static-pods-via-kubectl-command>https://stackoverflow.com/questions/65657808/how-to-identify-static-pods-via-kubectl-command</a></li>
</ul>
<h2 id=ë©”íŠ¸ë¦­-ì„œë²„ë¡œ-í”„ë¡œë©”í…Œìš°ìŠ¤-ì‚¬ìš©í•˜ê¸°>ë©”íŠ¸ë¦­ ì„œë²„ë¡œ í”„ë¡œë©”í…Œìš°ìŠ¤ ì‚¬ìš©í•˜ê¸°</h2>
<p>í”„ë¡œë©”í…Œìš°ìŠ¤ëŠ” <a href=https://kubernetes.io/ko/docs/tasks/debug-application-cluster/resource-usage-monitoring/#%EC%99%84%EC%A0%84%ED%95%9C-%EB%A9%94%ED%8A%B8%EB%A6%AD-%ED%8C%8C%EC%9D%B4%ED%94%84%EB%9D%BC%EC%9D%B8>ê¸°ë³¸ì ìœ¼ë¡œ ì¿ ë²„ë„¤í‹°ìŠ¤ì˜ ë…¸ë“œë¥¼ ëª¨ë‹ˆí„°ë‘ í•  ìˆ˜ ìˆë‹¤</a>ê³  í•œë‹¤. ë˜ <a href=https://www.cncf.io/projects/prometheus/>CNCF ì¡¸ì—… í”„ë¡œì íŠ¸ë¡œ ì¿ ë²„ë„¤í‹°ìŠ¤ë³´ë‹¤ ì¡¸ì—…ì¼ë„ ë¹ ë¥´ë‹¤(!)</a>. ë§ì€ ê³³ì—ì„œ ì“°ì´ë©°, ë‚œ íšŒì‚¬ì—ì„œ ë°ì´í„°ë…ì„ ì“°ëŠ”ë° ë¹„ìŠ·í•œ ì—­í• ë¡œ ì´í•´í•˜ê³  ìˆë‹¤.</p>
<p>(soundcloudê°€ ë§Œë“  ì˜¤í”ˆì†ŒìŠ¤ë¼ëŠ”ë°, ë¡œê³ ì˜ í†¤ì•¤ë§¤ë„ˆë¥¼ ë³´ë‹ˆ(=ë“£ê³ ë³´ë‹ˆ) ê·¸ëŸ°ê±° ê°™ë‹¤)</p>
<p>í”„ë¡œë©”í…Œìš°ìŠ¤ì˜ íŠ¹ì§•, ì¥ë‹¨ì , ì„ ì†Œê°œí•˜ëŠ” ê¸€ì€ ë§ì´ ìˆë‹¤. ë‹¤ìŒ ë‘ê°€ì§€ë¥¼ ì£¼ë¡œ ì´ì•¼ê¸°í•˜ëŠ”ë°:</p>
<ol>
<li>í˜¸ìŠ¤íŠ¸(ë…¸ë“œ)ì—ì„œ ë©”íŠ¸ë¦­ì„ push í•˜ì§€ ì•Šê³  ì„œë²„ì—ì„œ pull í•œë‹¤.</li>
<li>í´ëŸ¬ìŠ¤í„° êµ¬ì„±(HA, scale-out, &mldr;)ì´ ì–´ë µë‹¤.</li>
</ol>
<p>ë¨¼ì € ì²«ë²ˆì§¸ëŠ”, ë°ì´í„°ë…ì„ ì¨ë³¸ ë‚´ ì…ì¥ì—ì„œ, ì™„ì „í•œ ì¥ì ì€ ì•„ë‹Œê±° ê°™ë‹¤. ë°ì´í„°ë…ì€ ëª¨ë‹ˆí„° ì•ˆí•˜ë˜ ë©”íŠ¸ë¦­ë„ ê³„ì† ìŒ“ì•„ë‘ê³  ìˆë‹¤. ê·¸ë˜ì„œ ë‚˜ì¤‘ì— ê·¸ìª½ì— ë¬¸ì œê°€ ìƒê¸°ë©´ ê³¼ê±° ë©”íŠ¸ë¦­ë„ ë³¼ ìˆ˜ ìˆì–´ì„œ ì¢‹ì•˜ë‹¤.</p>
<p>í•˜ì§€ë§Œ ì§€ê¸ˆì€ ê°„ë‹¨í•œ ì‹¤ìŠµìš©ìœ¼ë¡œ êµ¬ì„±í•˜ëŠ” ê²ƒì´ ëª©ì ì¸ë°, ì´ëŸ° ë©´ì—ì„  ì¢‹ì€ê±° ê°™ë‹¤. ë°ì´í„°ë…ì€ í˜¸ìŠ¤íŠ¸ì— ì—ì´ì „íŠ¸ ì„¤ì¹˜í•˜ê³  ì§€ì›í•˜ëŠ” ì•± í†µí•©(integration) ì„¤ì •í•˜ë©´ ì•Œì•„ì„œ í•´ì£¼ì–´ í¸í•˜ê¸´ í•˜ì§€ë§Œ, ì´ëŸ¬ë©´ <em>ì–´ë–¤ ë©”íŠ¸ë¦­ì„ ìˆ˜ì§‘í•´ì•¼ì§€ì— ëŒ€í•œ ì§€ì‹ì´ë‚˜ ê¸°ìˆ ì€ ë‚´ê²ƒì´ ì•„ë‹ˆê²Œ ëœë‹¤.</em> ì´ ë¶€ë¶„ì´ ì§€ê¸ˆì˜ í”„ë¡œë©”í…Œìš°ìŠ¤ ì—°ë™ ì—°ìŠµì„ í•˜ëŠ”ë° í° ë™ê¸°ê°€ ëë‹¤. ë˜ ì‹¤ì œ ìš´ì˜ì‹œ ë©”íŠ¸ë¦­ ì„œë²„ë¥¼ ì§ì ‘ êµ¬ì„±í•˜ë‹ˆ, í•„ìš”í•œ ë©”íŠ¸ë¦­ë§Œ ìˆ˜ì§‘í•˜ì—¬ ë¦¬ì†ŒìŠ¤ë¥¼ ìµœì í™”í•œë‹¤ëŠ” ì¥ì ì´ ìˆë‹¤.</p>
<p>ë‘ë²ˆì§¸ íŠ¹ì§•ì¸ í´ëŸ¬ìŠ¤í„° êµ¬ì„±ì— ëŒ€í•´ì„  ë‹¨ì ì´ë¼ê³  ì´ì•¼ê¸° í•˜ëŠ” ê¸€ë“¤ì´ ë§ë‹¤. í•˜ì§€ë§Œ ì§€ê¸ˆ ì‹¤ìŠµì—ì„  ì „í˜€ ë¬¸ì œë˜ì§€ ì•ŠëŠ”ë‹¤.</p>
<p>ì§€ê¸ˆë¶€í„° í”„ë¡œë©”í…Œìš°ìŠ¤ ì‹¤ìŠµì—ì„  ì¿ ë²„ë„¤í‹°ìŠ¤ ê´€ë ¨í•œ ë‚´ìš©ì€ ì‹œë§¨í‹± ì„¤ëª…ë§Œ í•œë‹¤. ì‹œí—˜ ì¤€ë¹„í•˜ë©´ì„œ ì •ë¦¬í–ˆë˜ ë‚´ìš©ì´ë‚˜ ë˜ ì•ìœ¼ë¡œ ë°°ìš¸ ë‚´ìš©ê³¼ ê²¹ì¹˜ê¸° ë•Œë¬¸ì´ë‹¤. ëŒ€ì‹  í”„ë¡œë©”í…Œìš°ìŠ¤ ê´€ë ¨í•œ ë¶€ë¶„ì€ ì¡°ê¸ˆ ìì„¸íˆ ì‚´í´ë³¸ë‹¤(<em>ì°¸ê³ í•œ ë§í¬ ì˜ˆì‹œë“¤ê³¼ ë‹¬ë¦¬ íŒŒë“œëŠ” ì œì™¸í•œ ë…¸ë“œ ë©”íŠ¸ë¦­ë§Œ ìˆ˜ì§‘í–ˆë‹¤. ë‹¹ì¥ í™œë°œíˆ ì‚¬ìš©í•˜ëŠ” íŒŒë“œê°€ ì—†ì–´ì„œ ê·¸ë ‡ê²Œ í–ˆë‹¤. í•„ìš”í•˜ë‹¤ë©´ ë‚˜ì¤‘ì— ì¶”ê°€í•´ë³¸ë‹¤</em>).</p>
<h3 id=í™˜ê²½>í™˜ê²½</h3>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>â¯ sw_vers
ProductName:    macOS
ProductVersion: 11.6.1
BuildVersion:   20G224

â¯ minikube version
minikube version: v1.24.0
commit: 76b94fb3c4e8ac5062daf70d60cf03ddcc0a741b
</code></pre></div><h3 id=kube-state-metricsksm>kube-state-metrics(KSM)</h3>
<p>ì¿ ë²„ë„¤í‹°ìŠ¤ì˜ ê¸°ë³¸ ì»´í¬ë„ŒíŠ¸ê°€ ì•„ë‹Œ ì˜¤ë¸Œì íŠ¸(íŒŒë“œ, ë…¸ë“œ, ë””í”Œë¡œì´ë¨¼íŠ¸ ë“±)ì˜ ë©”íŠ¸ë¦­ì„ ìˆ˜ì§‘í•˜ëŠ” ë„êµ¬ë‹¤. kube-apiserverë¥¼ listení•˜ì—¬ ì´ë¥¼ ìˆ˜í–‰í•œë‹¤. ì´ ì—­ì‹œ íŒŒë“œë¡œ ì‹¤í–‰ëœë‹¤.</p>
<p><a href=https://github.com/kubernetes/kube-state-metrics/tree/master/examples/standard>examples/standard</a>ì˜ ì •ì˜ë¥¼ ê·¸ëŒ€ë¡œ ì‚¬ìš©í–ˆë‹¤. sparse clone í•˜ë“  ë³µì‚¬í•˜ë“  ë¡œì»¬ë¡œ ì˜®ê²¨ì„œ apply í•˜ë©´
kube-systemì— ë°°í¬ëœê±¸ ë³¼ ìˆ˜ ìˆë‹¤:</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>â¯ kubectl get svc -n kube-system
NAME                 TYPE        CLUSTER-IP     EXTERNAL-IP   PORT<span style=color:#f92672>(</span>S<span style=color:#f92672>)</span>                  AGE
kube-dns             ClusterIP   10.96.0.10     &lt;none&gt;        53/UDP,53/TCP,9153/TCP   27d
kube-state-metrics   ClusterIP   None           &lt;none&gt;        8080/TCP,8081/TCP        25h
metrics-server       ClusterIP   10.97.185.37   &lt;none&gt;        443/TCP                  112m

â¯ kubectl get deploy -n kube-system
NAME                 READY   UP-TO-DATE   AVAILABLE   AGE
coredns              1/1     <span style=color:#ae81ff>1</span>            <span style=color:#ae81ff>1</span>           27d
kube-state-metrics   1/1     <span style=color:#ae81ff>1</span>            <span style=color:#ae81ff>1</span>           25h
metrics-server       1/1     <span style=color:#ae81ff>1</span>            <span style=color:#ae81ff>1</span>           112m
</code></pre></div><p>KSMì€ í”„ë¡œë©”í…Œìš°ìŠ¤ì—ì„œ ì¿ ë²„ë„¤í‹°ìŠ¤ ì˜¤ë¸Œì íŠ¸ ë©”íŠ¸ë¦­ì„ ìˆ˜ì§‘í•˜ëŠ”ë° ì‚¬ìš©í•˜ê²Œ ëœë‹¤. ë”°ë¼ì„œ NodePortë¡œ ì™¸ë¶€ ë…¸ì¶œí•˜ì§€ ì•Šê³  ë‚´ë¶€ IPë¡œë§Œ í†µì‹ í•œë‹¤.ConfigRoleì„ ì•„ì§ ê³µë¶€í•˜ì§„ ì•Šì•˜ì§€ë§Œ, KSMì˜ ê²ƒì„ ë³´ë©´ configmap, secrete, nodes, pods ë“±ì— ëŒ€í•œ ì½ê¸°(list, watch) ê¶Œí•œì„ ê°€ì§„ ì—­í• ì„ ë§Œë“ ë‹¤ê³  ìƒê°í•  ìˆ˜ ìˆë‹¤. ClusterRoleBindingì€ ìŠ¤ì¼€ì¤„ë§ ì‹œ pod binding APIì²˜ëŸ¼ ì—­í•  ìƒì„± APIë¼ ì´í•´í–ˆë‹¤.</p>
<h3 id=í”„ë¡œë©”í…Œìš°ìŠ¤>í”„ë¡œë©”í…Œìš°ìŠ¤</h3>
<p>ë¨¼ì € ëª¨ë‹ˆí„°ë§ ê´€ë ¨í•œ ë„¤ì„ìŠ¤í˜ì´ìŠ¤ë¥¼ ìƒì„±í•œë‹¤:</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>â¯ kubectl create ns monitoring
</code></pre></div><p>í”„ë¡œë©”í…Œìš°ìŠ¤ë„ KSMê³¼ ë¹„ìŠ·í•œ ê¶Œí•œì„ ì£¼ê¸° ìœ„í•´ í”„ë¡œë©”í…Œìš°ìŠ¤ì˜ ê´€ì‹¬ì‚¬ì— ëŒ€í•´ ConfigRoleì„ ì •ì˜í•˜ê³  ìƒì„±(ConfigRoleBinding)í•œë‹¤:</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yml data-lang=yml><span style=color:#75715e># prometheus-cluster-role.yml</span>
<span style=color:#f92672>apiVersion</span>: <span style=color:#ae81ff>rbac.authorization.k8s.io/v1</span>
<span style=color:#f92672>kind</span>: <span style=color:#ae81ff>ClusterRole</span>
<span style=color:#f92672>metadata</span>:
  <span style=color:#f92672>name</span>: <span style=color:#ae81ff>prometheus</span>
  <span style=color:#f92672>namespace</span>: <span style=color:#ae81ff>monitoring</span>
<span style=color:#f92672>rules</span>:
- <span style=color:#f92672>apiGroups</span>: [<span style=color:#e6db74>&#34;&#34;</span>]
  <span style=color:#f92672>resources</span>:
  - <span style=color:#ae81ff>nodes</span>
  - <span style=color:#ae81ff>nodes/proxy</span>
  - <span style=color:#ae81ff>services</span>
  - <span style=color:#ae81ff>endpoints</span>
  - <span style=color:#ae81ff>pods</span>
  <span style=color:#f92672>verbs</span>: [<span style=color:#e6db74>&#34;get&#34;</span>, <span style=color:#e6db74>&#34;list&#34;</span>, <span style=color:#e6db74>&#34;watch&#34;</span>]
- <span style=color:#f92672>apiGroups</span>:
  - <span style=color:#ae81ff>extensions</span>
  <span style=color:#f92672>resources</span>:
  - <span style=color:#ae81ff>ingresses</span>
  <span style=color:#f92672>verbs</span>: [<span style=color:#e6db74>&#34;get&#34;</span>, <span style=color:#e6db74>&#34;list&#34;</span>, <span style=color:#e6db74>&#34;watch&#34;</span>]
- <span style=color:#f92672>nonResourceURLs</span>: [<span style=color:#e6db74>&#34;/metrics&#34;</span>]
  <span style=color:#f92672>verbs</span>: [<span style=color:#e6db74>&#34;get&#34;</span>]
---
<span style=color:#f92672>apiVersion</span>: <span style=color:#ae81ff>rbac.authorization.k8s.io/v1</span>
<span style=color:#f92672>kind</span>: <span style=color:#ae81ff>ClusterRoleBinding</span>
<span style=color:#f92672>metadata</span>:
  <span style=color:#f92672>name</span>: <span style=color:#ae81ff>prometheus</span>
<span style=color:#f92672>roleRef</span>:
  <span style=color:#f92672>apiGroup</span>: <span style=color:#ae81ff>rbac.authorization.k8s.io</span>
  <span style=color:#f92672>kind</span>: <span style=color:#ae81ff>ClusterRole</span>
  <span style=color:#f92672>name</span>: <span style=color:#ae81ff>prometheus</span>
<span style=color:#f92672>subjects</span>:
- <span style=color:#f92672>kind</span>: <span style=color:#ae81ff>ServiceAccount</span>
  <span style=color:#f92672>name</span>: <span style=color:#ae81ff>default</span>
  <span style=color:#f92672>namespace</span>: <span style=color:#ae81ff>monitoring</span>
</code></pre></div><p>ê·¸ë¦¬ê³  í”„ë¡œë©”í…Œìš°ìŠ¤ ì„œë²„ íŒŒë“œ ê´€ë ¨í•œ ë¦¬ì†ŒìŠ¤ë¥¼ ì •ì˜í•œë‹¤. ì—°ìŠµìš©ì´ë‹ˆ íŒŒë“œ í•˜ë‚˜ë§Œ ë°°í¬í•œë‹¤. ë¡œì»¬(ì™¸ë¶€)ì—ì„œ ì ‘ì†í•  ìˆ˜ ìˆê²Œ ì™¸ë¶€ ë…¸ì¶œ ì„œë¹„ìŠ¤ë„ í•„ìš”í•˜ë‹¤:</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yml data-lang=yml><span style=color:#75715e># prometheus.yml </span>
<span style=color:#f92672>apiVersion</span>: <span style=color:#ae81ff>apps/v1</span>
<span style=color:#f92672>kind</span>: <span style=color:#ae81ff>Deployment</span>
<span style=color:#f92672>metadata</span>:
  <span style=color:#f92672>name</span>: <span style=color:#ae81ff>prometheus-deployment</span>
  <span style=color:#f92672>namespace</span>: <span style=color:#ae81ff>monitoring</span>
<span style=color:#f92672>spec</span>:
  <span style=color:#f92672>replicas</span>: <span style=color:#ae81ff>1</span>
  <span style=color:#f92672>selector</span>:
    <span style=color:#f92672>matchLabels</span>:
      <span style=color:#f92672>app</span>: <span style=color:#ae81ff>prometheus-server</span>
  <span style=color:#f92672>template</span>:
    <span style=color:#f92672>metadata</span>:
      <span style=color:#f92672>labels</span>:
        <span style=color:#f92672>app</span>: <span style=color:#ae81ff>prometheus-server</span>
    <span style=color:#f92672>spec</span>:
      <span style=color:#f92672>containers</span>:
        - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>prometheus</span>
          <span style=color:#f92672>image</span>: <span style=color:#ae81ff>prom/prometheus:latest</span>
          <span style=color:#f92672>args</span>:
            - <span style=color:#e6db74>&#34;--config.file=/etc/prometheus/prometheus.yml&#34;</span>
            - <span style=color:#e6db74>&#34;--storage.tsdb.path=/prometheus/&#34;</span>
          <span style=color:#f92672>ports</span>:
            - <span style=color:#f92672>containerPort</span>: <span style=color:#ae81ff>9090</span>
          <span style=color:#f92672>volumeMounts</span>:
            - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>prometheus-config-volume</span>
              <span style=color:#f92672>mountPath</span>: <span style=color:#ae81ff>/etc/prometheus/</span>
            - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>prometheus-storage-volume</span>
              <span style=color:#f92672>mountPath</span>: <span style=color:#ae81ff>/prometheus/</span>
      <span style=color:#f92672>volumes</span>:
        - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>prometheus-config-volume</span>
          <span style=color:#f92672>configMap</span>:
            <span style=color:#f92672>defaultMode</span>: <span style=color:#ae81ff>420</span>
            <span style=color:#f92672>name</span>: <span style=color:#ae81ff>prometheus-server-conf</span>

        - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>prometheus-storage-volume</span>
          <span style=color:#f92672>emptyDir</span>: {}
---
<span style=color:#f92672>apiVersion</span>: <span style=color:#ae81ff>v1</span>
<span style=color:#f92672>kind</span>: <span style=color:#ae81ff>Service</span>
<span style=color:#f92672>metadata</span>:
  <span style=color:#f92672>name</span>: <span style=color:#ae81ff>prometheus-service</span>
  <span style=color:#f92672>namespace</span>: <span style=color:#ae81ff>monitoring</span>
  <span style=color:#f92672>annotations</span>:
      <span style=color:#f92672>prometheus.io/scrape</span>: <span style=color:#e6db74>&#39;true&#39;</span>
      <span style=color:#f92672>prometheus.io/port</span>:   <span style=color:#e6db74>&#39;9090&#39;</span>
<span style=color:#f92672>spec</span>:
  <span style=color:#f92672>selector</span>:
    <span style=color:#f92672>app</span>: <span style=color:#ae81ff>prometheus-server</span>
  <span style=color:#f92672>type</span>: <span style=color:#ae81ff>NodePort</span>
  <span style=color:#f92672>ports</span>:
    - <span style=color:#f92672>port</span>: <span style=color:#ae81ff>8080</span>
      <span style=color:#f92672>targetPort</span>: <span style=color:#ae81ff>9090</span>
</code></pre></div><p>ìŠ¤í† ë¦¬ì§€ ë³¼ë¥¨ì€ ê·¸ëƒ¥ ë¹ˆ ë””ë ‰í† ë¦¬ë¥¼ ì¤€ë‹¤. í”„ë¡œë©”í…Œìš°ìŠ¤ ì„¤ì • íŒŒì¼ì„ íŒŒë“œì— ë„˜ê²¨ì¤„ ìˆ˜ ìˆëŠ” ConfigMapì„ ì •ì˜í•œë‹¤. ë¨¼ì € í”„ë¡œë©”í…Œìš°ìŠ¤ ì„¤ì • íŒŒì¼ì€ ë‹¤ìŒê³¼ ê°™ë‹¤. ìœ„ì˜ íŒŒë“œ ë¦¬ì†ŒìŠ¤ ì •ì˜ì™€ í—·ê°ˆë¦¬ì§€ ì•Šê²Œ í”„ë¡œë©”í…Œìš°ìŠ¤ config/prometheus.ymlì— íŒŒì¼ì„ ì¼ë‹¤:</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yml data-lang=yml><span style=color:#75715e># config/prometheus.yml</span>
<span style=color:#f92672>global</span>:
  <span style=color:#f92672>scrape_interval</span>: <span style=color:#ae81ff>5s</span>
  <span style=color:#f92672>evaluation_interval</span>: <span style=color:#ae81ff>5s</span>
<span style=color:#f92672>scrape_configs</span>:
  - <span style=color:#f92672>job_name</span>: <span style=color:#e6db74>&#39;kubernetes-apiservers&#39;</span>

    <span style=color:#f92672>kubernetes_sd_configs</span>:
    - <span style=color:#f92672>role</span>: <span style=color:#ae81ff>endpoints</span>
    <span style=color:#f92672>scheme</span>: <span style=color:#ae81ff>https</span>

    <span style=color:#f92672>tls_config</span>:
      <span style=color:#f92672>ca_file</span>: <span style=color:#ae81ff>/var/run/secrets/kubernetes.io/serviceaccount/ca.crt</span>
    <span style=color:#f92672>bearer_token_file</span>: <span style=color:#ae81ff>/var/run/secrets/kubernetes.io/serviceaccount/token</span>

    <span style=color:#f92672>relabel_configs</span>:
    - <span style=color:#f92672>source_labels</span>: [<span style=color:#ae81ff>__meta_kubernetes_namespace, __meta_kubernetes_service_name, __meta_kubernetes_endpoint_port_name]</span>
      <span style=color:#f92672>action</span>: <span style=color:#ae81ff>keep</span>
      <span style=color:#f92672>regex</span>: <span style=color:#ae81ff>default;kubernetes;https</span>

  - <span style=color:#f92672>job_name</span>: <span style=color:#e6db74>&#39;kubernetes-nodes&#39;</span>

    <span style=color:#f92672>scheme</span>: <span style=color:#ae81ff>https</span>

    <span style=color:#f92672>tls_config</span>:
      <span style=color:#f92672>ca_file</span>: <span style=color:#ae81ff>/var/run/secrets/kubernetes.io/serviceaccount/ca.crt</span>
    <span style=color:#f92672>bearer_token_file</span>: <span style=color:#ae81ff>/var/run/secrets/kubernetes.io/serviceaccount/token</span>

    <span style=color:#f92672>kubernetes_sd_configs</span>:
    - <span style=color:#f92672>role</span>: <span style=color:#ae81ff>node</span>

    <span style=color:#f92672>relabel_configs</span>:
    - <span style=color:#f92672>action</span>: <span style=color:#ae81ff>labelmap</span>
      <span style=color:#f92672>regex</span>: <span style=color:#ae81ff>__meta_kubernetes_node_label_(.+)</span>
    - <span style=color:#f92672>target_label</span>: <span style=color:#ae81ff>__address__</span>
      <span style=color:#f92672>replacement</span>: <span style=color:#ae81ff>kubernetes.default.svc:443</span>
    - <span style=color:#f92672>source_labels</span>: [<span style=color:#ae81ff>__meta_kubernetes_node_name]</span>
      <span style=color:#f92672>regex</span>: <span style=color:#ae81ff>(.+)</span>
      <span style=color:#f92672>target_label</span>: <span style=color:#ae81ff>__metrics_path__</span>
      <span style=color:#f92672>replacement</span>: <span style=color:#ae81ff>/api/v1/nodes/${1}/proxy/metrics</span>


  - <span style=color:#f92672>job_name</span>: <span style=color:#e6db74>&#39;kubernetes-pods&#39;</span>

    <span style=color:#f92672>kubernetes_sd_configs</span>:
    - <span style=color:#f92672>role</span>: <span style=color:#ae81ff>pod</span>

    <span style=color:#f92672>relabel_configs</span>:
    - <span style=color:#f92672>source_labels</span>: [<span style=color:#ae81ff>__meta_kubernetes_pod_annotation_prometheus_io_scrape]</span>
      <span style=color:#f92672>action</span>: <span style=color:#ae81ff>keep</span>
      <span style=color:#f92672>regex</span>: <span style=color:#66d9ef>true</span>
    - <span style=color:#f92672>source_labels</span>: [<span style=color:#ae81ff>__meta_kubernetes_pod_annotation_prometheus_io_path]</span>
      <span style=color:#f92672>action</span>: <span style=color:#ae81ff>replace</span>
      <span style=color:#f92672>target_label</span>: <span style=color:#ae81ff>__metrics_path__</span>
      <span style=color:#f92672>regex</span>: <span style=color:#ae81ff>(.+)</span>
    - <span style=color:#f92672>source_labels</span>: [<span style=color:#ae81ff>__address__, __meta_kubernetes_pod_annotation_prometheus_io_port]</span>
      <span style=color:#f92672>action</span>: <span style=color:#ae81ff>replace</span>
      <span style=color:#f92672>regex</span>: <span style=color:#ae81ff>([^:]+)(?::\d+)?;(\d+)</span>
      <span style=color:#f92672>replacement</span>: <span style=color:#ae81ff>$1:$2</span>
      <span style=color:#f92672>target_label</span>: <span style=color:#ae81ff>__address__</span>
    - <span style=color:#f92672>action</span>: <span style=color:#ae81ff>labelmap</span>
      <span style=color:#f92672>regex</span>: <span style=color:#ae81ff>__meta_kubernetes_pod_label_(.+)</span>
    - <span style=color:#f92672>source_labels</span>: [<span style=color:#ae81ff>__meta_kubernetes_namespace]</span>
      <span style=color:#f92672>action</span>: <span style=color:#ae81ff>replace</span>
      <span style=color:#f92672>target_label</span>: <span style=color:#ae81ff>kubernetes_namespace</span>
    - <span style=color:#f92672>source_labels</span>: [<span style=color:#ae81ff>__meta_kubernetes_pod_name]</span>
      <span style=color:#f92672>action</span>: <span style=color:#ae81ff>replace</span>
      <span style=color:#f92672>target_label</span>: <span style=color:#ae81ff>kubernetes_pod_name</span>

  - <span style=color:#f92672>job_name</span>: <span style=color:#e6db74>&#39;kube-state-metrics&#39;</span>
    <span style=color:#f92672>static_configs</span>:
      - <span style=color:#f92672>targets</span>: [<span style=color:#e6db74>&#39;kube-state-metrics.kube-system.svc.cluster.local:8080&#39;</span>]

  - <span style=color:#f92672>job_name</span>: <span style=color:#e6db74>&#39;kubernetes-cadvisor&#39;</span>

    <span style=color:#f92672>scheme</span>: <span style=color:#ae81ff>https</span>

    <span style=color:#f92672>tls_config</span>:
      <span style=color:#f92672>ca_file</span>: <span style=color:#ae81ff>/var/run/secrets/kubernetes.io/serviceaccount/ca.crt</span>
    <span style=color:#f92672>bearer_token_file</span>: <span style=color:#ae81ff>/var/run/secrets/kubernetes.io/serviceaccount/token</span>

    <span style=color:#f92672>kubernetes_sd_configs</span>:
    - <span style=color:#f92672>role</span>: <span style=color:#ae81ff>node</span>

    <span style=color:#f92672>relabel_configs</span>:
    - <span style=color:#f92672>action</span>: <span style=color:#ae81ff>labelmap</span>
      <span style=color:#f92672>regex</span>: <span style=color:#ae81ff>__meta_kubernetes_node_label_(.+)</span>
    - <span style=color:#f92672>target_label</span>: <span style=color:#ae81ff>__address__</span>
      <span style=color:#f92672>replacement</span>: <span style=color:#ae81ff>kubernetes.default.svc:443</span>
    - <span style=color:#f92672>source_labels</span>: [<span style=color:#ae81ff>__meta_kubernetes_node_name]</span>
      <span style=color:#f92672>regex</span>: <span style=color:#ae81ff>(.+)</span>
      <span style=color:#f92672>target_label</span>: <span style=color:#ae81ff>__metrics_path__</span>
      <span style=color:#f92672>replacement</span>: <span style=color:#ae81ff>/api/v1/nodes/${1}/proxy/metrics/cadvisor</span>

  - <span style=color:#f92672>job_name</span>: <span style=color:#e6db74>&#39;kubernetes-service-endpoints&#39;</span>

    <span style=color:#f92672>kubernetes_sd_configs</span>:
    - <span style=color:#f92672>role</span>: <span style=color:#ae81ff>endpoints</span>

    <span style=color:#f92672>relabel_configs</span>:
    - <span style=color:#f92672>source_labels</span>: [<span style=color:#ae81ff>__meta_kubernetes_service_annotation_prometheus_io_scrape]</span>
      <span style=color:#f92672>action</span>: <span style=color:#ae81ff>keep</span>
      <span style=color:#f92672>regex</span>: <span style=color:#66d9ef>true</span>
    - <span style=color:#f92672>source_labels</span>: [<span style=color:#ae81ff>__meta_kubernetes_service_annotation_prometheus_io_scheme]</span>
      <span style=color:#f92672>action</span>: <span style=color:#ae81ff>replace</span>
      <span style=color:#f92672>target_label</span>: <span style=color:#ae81ff>__scheme__</span>
      <span style=color:#f92672>regex</span>: <span style=color:#ae81ff>(https?)</span>
    - <span style=color:#f92672>source_labels</span>: [<span style=color:#ae81ff>__meta_kubernetes_service_annotation_prometheus_io_path]</span>
      <span style=color:#f92672>action</span>: <span style=color:#ae81ff>replace</span>
      <span style=color:#f92672>target_label</span>: <span style=color:#ae81ff>__metrics_path__</span>
      <span style=color:#f92672>regex</span>: <span style=color:#ae81ff>(.+)</span>
    - <span style=color:#f92672>source_labels</span>: [<span style=color:#ae81ff>__address__, __meta_kubernetes_service_annotation_prometheus_io_port]</span>
      <span style=color:#f92672>action</span>: <span style=color:#ae81ff>replace</span>
      <span style=color:#f92672>target_label</span>: <span style=color:#ae81ff>__address__</span>
      <span style=color:#f92672>regex</span>: <span style=color:#ae81ff>([^:]+)(?::\d+)?;(\d+)</span>
      <span style=color:#f92672>replacement</span>: <span style=color:#ae81ff>$1:$2</span>
    - <span style=color:#f92672>action</span>: <span style=color:#ae81ff>labelmap</span>
      <span style=color:#f92672>regex</span>: <span style=color:#ae81ff>__meta_kubernetes_service_label_(.+)</span>
    - <span style=color:#f92672>source_labels</span>: [<span style=color:#ae81ff>__meta_kubernetes_namespace]</span>
      <span style=color:#f92672>action</span>: <span style=color:#ae81ff>replace</span>
      <span style=color:#f92672>target_label</span>: <span style=color:#ae81ff>kubernetes_namespace</span>
    - <span style=color:#f92672>source_labels</span>: [<span style=color:#ae81ff>__meta_kubernetes_service_name]</span>
      <span style=color:#f92672>action</span>: <span style=color:#ae81ff>replace</span>
      <span style=color:#f92672>target_label</span>: <span style=color:#ae81ff>kubernetes_name</span>
</code></pre></div><ul>
<li>global.scrape_interval: íƒ€ê²Ÿì„ ìŠ¤í¬ë©í•˜ëŠ” ê¸°ë³¸ ì£¼ê¸°</li>
<li>global.evaluation_interval: ë£°ì„ í‰ê°€í•˜ëŠ” ê¸°ë³¸ ì£¼ê¸°</li>
<li>scrape_configs[*].job_name: ìŠ¤í¬ë©í•˜ëŠ” íƒ€ê²Ÿ ì´ë¦„</li>
<li>scrape_configs[*].kubernetes_sd_configs: ì¿ ë²„ë„¤í‹°ìŠ¤ ì„œë¹„ìŠ¤ ë””ìŠ¤ì»¤ë²„ë¦¬ ì„¤ì •, kube-apiserverì—ì„œ íƒ€ê²Ÿì„ ìŠ¤í¬ë©í•˜ëŠ” ê²ƒì— ëŒ€í•œ ì„¤ì •</li>
<li><a href=https://prometheus.io/docs/prometheus/latest/configuration/configuration/#kubernetes_sd_config>scrape_configs[*].kubernetes_sd_configs[*].role</a></li>
</ul>
<p>ìœ„ì™€ ê°™ì€ í”„ë¡œë©”í…Œìš°ìŠ¤ê°€ ê¸°ë³¸ìœ¼ë¡œ ì œê³µ ì„œë¹„ìŠ¤ ë””ìŠ¤ì»¤ë²„ë¦¬ ì„¤ì •ì´ ë§ì´ ëŒì•„ë‹¤ë‹Œë‹¤. KSMì˜ ê²½ìš°ëŠ” ìœ„ì—ì„œ ì„¤ì¹˜í•œ ì—”ë“œí¬ì¸íŠ¸ë¥¼ static_configs.[0].targets ì¤‘ í•˜ë‚˜ë¡œ ë…¸ì¶œí•œë‹¤. ìœ„ íŒŒì¼ë¡œ ConfigMapì„ ë§Œë“¤ì–´ í”„ë¡œë©”í…Œìš°ìŠ¤ íŒŒë“œì— ë§ˆìš´íŠ¸í•œë‹¤:</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yml data-lang=yml> <span style=color:#ae81ff>kubectl create configmap prometheus-server-conf --from-file=config/prometheus.yml -n monitoring</span>
</code></pre></div><p>ì§€ê¸ˆê¹Œì§€ ë§Œë“  ì˜¤ë¸Œì íŠ¸ ì •ì˜ë¥¼ ëª¨ë‘ ì ìš©í•˜ë©´(<code>kubectl apply -f .</code>) í”„ë¡œë©”í…Œìš°ìŠ¤ê°€ ì‹œì‘ëœë‹¤. í”„ë¡œë©”í…Œìš°ìŠ¤ ì„œë¹„ìŠ¤ ì£¼ì†Œë¥¼ ì°¾ì•„ ë¸Œë¼ìš°ì €ë¡œ ì ‘ì†í•˜ë©´ ê¸°ë³¸ UIë¥¼ ë³¼ ìˆ˜ ìˆë‹¤:</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>â¯ minikube service --url prometheus-service -n monitoring
http://192.168.64.2:30003
</code></pre></div><p><img src=/images/cka-4-logging-monitoring/1.png alt=1></p>
<p>ìƒë‹¨ ë©”ë‰´ì—ì„œ Status > Targetsì„ í´ë¦­í•˜ë©´ í”„ë¡œë©”í…Œìš°ìŠ¤ ì„¤ì •(config/prometheus.yml)ì—ì„œ ì •ì˜í•œ job ë‹¨ìœ„ë¡œ ìˆ˜ì§‘í•˜ëŠ” ë©”íŠ¸ë¦­ ì¶œì²˜ì˜ ì—”ë“œí¬ì¸íŠ¸ë¥¼ ë³¼ ìˆ˜ ìˆë‹¤. Statusì˜ ë‹¤ë¥¸ ë©”ë‰´ì¸ Service Discoveryë¥¼ ë³´ë©´ ì„¤ì •ì˜ source_labelsì™€ Discovered Labelsê°€ ë§¤ì¹­ëœë‹¤:</p>
<p><img src=/images/cka-4-logging-monitoring/2.png alt=2></p>
<h2 id=ë…¸ë“œ-ìµìŠ¤í¬í„°>ë…¸ë“œ ìµìŠ¤í¬í„°</h2>
<p>kube-apiserver KSMìœ¼ë¡œë¶€í„° ìˆ˜ì§‘í•˜ëŠ” ì‹œìŠ¤í…œ ë©”íŠ¸ë¦­ ì™¸ì˜ ë©”íŠ¸ë¦­ì„ ìˆ˜ì§‘í•˜ê¸° ìœ„í•´ ë…¸ë“œ ìµìŠ¤í¬í„°ë¥¼ ì„¤ì¹˜í•œë‹¤. ìµìŠ¤í¬í„°ëŠ” í˜¸ìŠ¤íŠ¸ì˜ í•„ìš”í•œ ë©”íŠ¸ë¦­ì„ í”„ë¡œë©”í…Œìš°ìŠ¤ë¡œ ë³´ë‚´ì£¼ëŠ” ì—­í• ì„ í•œë‹¤. ì»¨í…Œì´ë„ˆ ì´ë¯¸ì§€ê°€ ìˆê¸° ë•Œë¬¸ì— ê°„ë‹¨í•˜ê²Œ ì„¤ì¹˜í•  ìˆ˜ ìˆë‹¤. ë…¸ë“œë§ˆë‹¤ í•„ìš”í•˜ê¸° ë•Œë¬¸ì— ëŒ€ëª¬ì…‹ìœ¼ë¡œ ì„¤ì¹˜í•œë‹¤:</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yml data-lang=yml><span style=color:#75715e># prometheus-node-exporter.yaml</span>

<span style=color:#f92672>apiVersion</span>: <span style=color:#ae81ff>apps/v1</span>
<span style=color:#f92672>kind</span>: <span style=color:#ae81ff>DaemonSet</span>
<span style=color:#f92672>metadata</span>:
  <span style=color:#f92672>name</span>: <span style=color:#ae81ff>node-exporter</span>
  <span style=color:#f92672>namespace</span>: <span style=color:#ae81ff>monitoring</span>
  <span style=color:#f92672>labels</span>:
    <span style=color:#f92672>k8s-app</span>: <span style=color:#ae81ff>node-exporter</span>
<span style=color:#f92672>spec</span>:
  <span style=color:#f92672>selector</span>:
    <span style=color:#f92672>matchLabels</span>:
      <span style=color:#f92672>k8s-app</span>: <span style=color:#ae81ff>node-exporter</span>
  <span style=color:#f92672>template</span>:
    <span style=color:#f92672>metadata</span>:
      <span style=color:#f92672>labels</span>:
        <span style=color:#f92672>k8s-app</span>: <span style=color:#ae81ff>node-exporter</span>
    <span style=color:#f92672>spec</span>:
      <span style=color:#f92672>containers</span>:
      - <span style=color:#f92672>image</span>: <span style=color:#ae81ff>prom/node-exporter</span>
        <span style=color:#f92672>name</span>: <span style=color:#ae81ff>node-exporter</span>
        <span style=color:#f92672>ports</span>:
        - <span style=color:#f92672>containerPort</span>: <span style=color:#ae81ff>9100</span>
          <span style=color:#f92672>protocol</span>: <span style=color:#ae81ff>TCP</span>
          <span style=color:#f92672>name</span>: <span style=color:#ae81ff>http</span>
</code></pre></div><p>(ë…¸ë“œ ìµìŠ¤í¬í„°ëŠ” í”„ë¡œë©”í…Œìš°ìŠ¤ì™€ í†µì‹ ë§Œ í•˜ë©´ ë˜ê¸° ë•Œë¬¸ì— ì„œë¹„ìŠ¤ ë…¸ì¶œì€ í•„ìš” ì—†ë‹¤. ê·¸ëŸ°ë° ì°¸ê³ í•œ ì˜ˆì œë¥¼ í¬í•¨í•´ì„œ ì›¬ë§Œí•œ ì˜ˆì œë“¤ì€ ë‹¤ NodePort ì„œë¹„ìŠ¤ë¥¼ í•˜ë‚˜ì”© ë§Œë“¤ë”ë¼&mldr; ê·¸ë˜ì„œ ì—¬ê¸°ì„  ì•ˆ ë§Œë“¤ì—ˆë‹¤)</p>
<p>ë…¸ë“œ ìµìŠ¤í¬í„°ë¥¼ ì‹¤í–‰í•˜ê³  í”„ë¼ì´ë¹— IPë¥¼ í™•ì¸í•œë‹¤:</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>â¯ kubectl describe po node-exporter-7nrhs -n monitoring | grep IP
IP:           172.17.0.9
IPs:
  IP:           172.17.0.9
</code></pre></div><p>í”„ë¡œë©”í…Œìš°ìŠ¤ê°€ ë“¤ì„ ìˆ˜ ìˆê²Œ ì„œë¹„ìŠ¤ ë””ìŠ¤ì»¤ë²„ë¦¬ì— ì¶”ê°€í•œë‹¤. containerPortì¸ 9100ì„ íƒ€ê²Ÿìœ¼ë¡œ í•œë‹¤:</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yml data-lang=yml><span style=color:#75715e># config/prometheus.yml</span>
<span style=color:#f92672>global</span>:
  <span style=color:#ae81ff>...</span>
<span style=color:#f92672>scrape_configs</span>:
- <span style=color:#f92672>job_name</span>: <span style=color:#e6db74>&#39;server-infos&#39;</span>
  <span style=color:#f92672>static_configs</span>:
  - <span style=color:#f92672>targets</span>: [<span style=color:#e6db74>&#39;172.17.0.9:9100&#39;</span>]
  <span style=color:#ae81ff>...</span>
</code></pre></div><p><img src=/images/cka-4-logging-monitoring/3.png alt=3></p>
<p>ì„¤ì •ì— ì¶”ê°€í•œ ì—”ë“œí¬ì¸íŠ¸ì— ëŒ€í•œ íƒ€ê²Ÿì´ ìƒê¸´ê±¸ í™•ì¸í•  ìˆ˜ ìˆë‹¤.</p>
<h3 id=ê·¸ë¼íŒŒë‚˜>ê·¸ë¼íŒŒë‚˜</h3>
<p>í”„ë¡œë©”í…Œìš°ìŠ¤ ê¸°ë³¸ UIë³´ë‹¤ ë” ë³´ê¸° í¸í•œ ëŒ€ì‹œë³´ë“œë¥¼ êµ¬ì„±í•˜ê¸° ìœ„í•´ ê·¸ë¼íŒŒë‚˜ë¥¼ ì‚¬ìš©í•œë‹¤. ë§ˆì°¬ê°€ì§€ë¡œ í•œ íŒŒë“œë§Œ ë°°í¬í•˜ê³  ë¡œì»¬ ë¸Œë¼ìš°ì €ì—ì„œ ë³¼ ìˆ˜ ìˆë„ë¡ NodePort ì„œë¹„ìŠ¤ë¥¼ ë…¸ì¶œí•œë‹¤:</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yml data-lang=yml><span style=color:#75715e># grafana.yml</span>
<span style=color:#f92672>apiVersion</span>: <span style=color:#ae81ff>apps/v1</span>
<span style=color:#f92672>kind</span>: <span style=color:#ae81ff>Deployment</span>
<span style=color:#f92672>metadata</span>:
  <span style=color:#f92672>name</span>: <span style=color:#ae81ff>grafana</span>
  <span style=color:#f92672>namespace</span>: <span style=color:#ae81ff>monitoring</span>
<span style=color:#f92672>spec</span>:
  <span style=color:#f92672>replicas</span>: <span style=color:#ae81ff>1</span>
  <span style=color:#f92672>selector</span>:
    <span style=color:#f92672>matchLabels</span>:
      <span style=color:#f92672>app</span>: <span style=color:#ae81ff>grafana</span>
  <span style=color:#f92672>template</span>:
    <span style=color:#f92672>metadata</span>:
      <span style=color:#f92672>name</span>: <span style=color:#ae81ff>grafana</span>
      <span style=color:#f92672>labels</span>:
        <span style=color:#f92672>app</span>: <span style=color:#ae81ff>grafana</span>
    <span style=color:#f92672>spec</span>:
      <span style=color:#f92672>containers</span>:
      - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>grafana</span>
        <span style=color:#f92672>image</span>: <span style=color:#ae81ff>grafana/grafana:latest</span>
        <span style=color:#f92672>ports</span>:
        - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>grafana</span>
          <span style=color:#f92672>containerPort</span>: <span style=color:#ae81ff>3000</span>
        <span style=color:#f92672>env</span>:
        - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>GF_SERVER_HTTP_PORT</span>
          <span style=color:#f92672>value</span>: <span style=color:#e6db74>&#34;3000&#34;</span>
        - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>GF_AUTH_BASIC_ENABLED</span>
          <span style=color:#f92672>value</span>: <span style=color:#e6db74>&#34;false&#34;</span>
        - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>GF_AUTH_ANONYMOUS_ENABLED</span>
          <span style=color:#f92672>value</span>: <span style=color:#e6db74>&#34;true&#34;</span>
        - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>GF_AUTH_ANONYMOUS_ORG_ROLE</span>
          <span style=color:#f92672>value</span>: <span style=color:#ae81ff>Admin</span>
        - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>GF_SERVER_ROOT_URL</span>
          <span style=color:#f92672>value</span>: <span style=color:#ae81ff>/</span>
---
<span style=color:#f92672>apiVersion</span>: <span style=color:#ae81ff>v1</span>
<span style=color:#f92672>kind</span>: <span style=color:#ae81ff>Service</span>
<span style=color:#f92672>metadata</span>:
  <span style=color:#f92672>name</span>: <span style=color:#ae81ff>grafana</span>
  <span style=color:#f92672>namespace</span>: <span style=color:#ae81ff>monitoring</span>
  <span style=color:#f92672>annotations</span>:
      <span style=color:#f92672>prometheus.io/scrape</span>: <span style=color:#e6db74>&#39;true&#39;</span>
      <span style=color:#f92672>prometheus.io/port</span>:   <span style=color:#e6db74>&#39;3000&#39;</span>
<span style=color:#f92672>spec</span>:
  <span style=color:#f92672>selector</span>:
    <span style=color:#f92672>app</span>: <span style=color:#ae81ff>grafana</span>
  <span style=color:#f92672>type</span>: <span style=color:#ae81ff>NodePort</span>
  <span style=color:#f92672>ports</span>:
    - <span style=color:#f92672>port</span>: <span style=color:#ae81ff>3000</span>
      <span style=color:#f92672>targetPort</span>: <span style=color:#ae81ff>3000</span>
</code></pre></div><p>apply í›„ ì„œë¹„ìŠ¤ URLì„ ì°¾ì•„ ì ‘ì†í•´ë³¸ë‹¤:</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>â¯ minikube service --url grafana -n monitoring
http://192.168.64.2:30004
</code></pre></div><p><img src=/images/cka-4-logging-monitoring/4.png alt=4></p>
<p>ì²« í˜ì´ì§€ì—ì„œ Data Sources ë¥¼ ëˆŒëŸ¬ Prometheusë¥¼ ê³ ë¥´ê³  í”„ë¡œë©”í…Œìš°ìŠ¤ì™€ ë°ì´í„°ë¥¼ ì—°ë™í•œë‹¤. HTTP URL ì„¤ì •ì„ ê¸°ë³¸ ê°’ì´ ì•„ë‹Œ í”„ë¡œë©”í…Œìš°ìŠ¤ ì„œë¹„ìŠ¤ë¥¼ ì°¾ì•„ ë°”ê¿”ì¤€ë‹¤. ì´ ì˜ˆì œì—ì„  í¬íŠ¸ëŠ” 8080ìœ¼ë¡œ í–ˆë‹¤:</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>â¯ kubectl get svc  -n monitoring
NAME                 TYPE       CLUSTER-IP      EXTERNAL-IP   PORT<span style=color:#f92672>(</span>S<span style=color:#f92672>)</span>          AGE
grafana              NodePort   10.102.154.48   &lt;none&gt;        3000:30004/TCP   21h
prometheus-service   NodePort   10.96.39.174    &lt;none&gt;        8080:30003/TCP   32h
</code></pre></div><p>ë‚˜ë¨¸ì§„ ê·¸ëŒ€ë¡œ ë‘ê³  í™”ë©´ ë°‘ìœ¼ë¡œ ë‚´ë ¤ Save & Test í•œë‹¤. ì²« í™”ë©´ìœ¼ë¡œ ëŒì•„ì™€ ëŒ€ì‹œë³´ë“œë¥¼ ë§Œë“ ë‹¤. ì¢Œì¸¡ ë©”ë‰´ +(Create) > Importë¥¼ ëˆ„ë¥´ë©´ grafana.comì— ì´ë¯¸ ê³µê°œë˜ì–´ ìˆëŠ” ëŒ€ì‹œë³´ë“œ íŒŒì¼ì„ ì„í¬íŠ¸í•  ìˆ˜ ìˆë‹¤. <a href=https://grafana.com/grafana/dashboards/>ê·¸ë¼íŒŒë‚˜ ëŒ€ì‹œë³´ë“œ í˜ì´ì§€</a>ì—ì„œ kubernetesë¡œ ê²€ìƒ‰í•˜ë©´ í”„ë¡œë©”í…Œìš°ìŠ¤ ë©”íŠ¸ë¦­ìœ¼ë¡œë¶€í„° ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ëŒ€ì‹œë³´ë“œë“¤ì´ ë‚˜ì˜¨ë‹¤. ë‚œ ë…¸ë“œ ê´€ë ¨ ëŒ€ì‹œë³´ë“œë¥¼ ë§Œë“¤ê¸° ìœ„í•´ <a href=https://grafana.com/grafana/dashboards/8171>8171</a>ë¥¼ ì„í¬íŠ¸ í–ˆë‹¤. ìœ„ í™”ë©´ì—ì„œ Import via grafana.com í¼ì— 8171ë§Œ ë„£ê³  Load í•˜ë©´ ëœë‹¤.</p>
<p><img src=/images/cka-4-logging-monitoring/5.png alt=5></p>
<p>ëŒ€ì‹œë³´ë“œ ì´ë¦„ì´ ë§ëŠ”ì§€ ì •ë„ í™•ì¸í•˜ê³  Prometheusì—ì„œ Prometheus(default)ë¥¼ ê³ ë¥¸ë‹¤. ê¸ˆë°© ì—°ë™í•œ ë°ì´í„° ì†ŒìŠ¤ í•˜ë‚˜ ë°–ì— ì—†ì„ ê²ƒì´ë‹¤.</p>
<p><img src=/images/cka-4-logging-monitoring/6.png alt=6></p>
<p>ì„í¬íŠ¸í•˜ë©´ ë…¸ë“œì˜ CPU, ë©”ëª¨ë¦¬, ë””ìŠ¤í¬, ë„¤íŠ¸ì›Œí¬ì— ëŒ€í•œ ê°„ë‹¨í•œ ëŒ€ì‹œë³´ë“œê°€ êµ¬ì„±ëœë‹¤.</p>
<p>ì°¸ê³ :</p>
<ul>
<li><a href=https://gruuuuu.github.io/cloud/monitoring-02/>Kubernetes Monitoring - Prometheus ì‹¤ìŠµ</a></li>
<li><a href=https://bcho.tistory.com/1270>ì¿ ë²„ë„¤í‹°ìŠ¤ #14 - ëª¨ë‹ˆí„°ë§ (2/3) Prometheus</a></li>
<li><a href=https://linux.systemv.pe.kr/kubernetes-monitoring-prometheus-%EC%84%A4%EC%B9%98/>KUBERNETES MONITORING â€“ PROMETHEUS ì„¤ì¹˜</a></li>
</ul>
<hr>
<p>í”„ë¡œë©”í…Œìš°ìŠ¤ì™€ ê·¸ë¼íŒŒë‚˜ë¥¼ ì²˜ìŒë¶€í„° ì—°ë™í•´ë´ì„œ ì¢‹ì•˜ë‹¤. í•˜ì§€ë§Œ ì—­ì‹œ ì‹¤ì œë¡œ ëª¨ë‹ˆí„°í•  í•„ìš”ê°€ í¬ê²Œ ì—†ìœ¼ë‹ˆ ë¬´ì–¼ë´ì•¼ í• ì§„ ì˜ ëª¨ë¥´ê² ë‹¤. ì°¸ê³ ì—” ìˆì—ˆì§€ë§Œ ì—¬ê¸°ì„  ë¹ ëœ¨ë¦° íŒŒë“œ ë©”íŠ¸ë¦­ì´ë‚˜ í”„ë¡œë©”í…Œìš°ìŠ¤ì˜ alert managerë„ ë‹¤ìŒì— ì¶”ê°€í•´ë´ì•¼ê² ë‹¤.</p>
<p>ê·¸ë¦¬ê³  ë‹¹ë¶„ê°„ CKA ì±•í„° ì •ë¦¬ê°€ ëœ¸í• ìˆ˜ë„ ìˆë‹¤. ì •ë¦¬í•˜ëŠ”ê±´ ì¢‹ì€ë° ìê¾¸ ì´ë ‡ê²Œ ì‹œí—˜ê³¼ ë¬´ê´€í•œ ìª½ì— ê´€ì‹¬ì´ ìƒê¸°ë‹¤ë³´ë‹ˆ ì§„ë„ê°€ ì˜ ì•ˆë¹ ì§€ëŠ”ê²ƒ ê°™ì•„ì„œ ë¹ ë¥´ê²Œ 1íšŒê°•ì„ í•´ë³´ë ¤ê³  í•œë‹¤.</p>
</div>
</section>
<div id=disqus_thread></div>
<script type=application/javascript>var disqus_config=function(){};(function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById('disqus_thread').innerHTML='Disqus comments not available by default when the website is previewed locally.';return}var b=document,a=b.createElement('script');a.async=!0,a.src='//flavono123.disqus.com/embed.js',a.setAttribute('data-timestamp',+new Date),(b.head||b.body).appendChild(a)})()</script>
<noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript>
<a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a>
<footer>
<p>&copy; 2021 - 2022 </p>
</footer>
</main>
</body>
</html>